# C3.2 — Расчёт компонент временной архитектуры реакции  

(Component Timing Computation v4)

## 1. Назначение документа

Настоящий документ описывает вычислительный слой **C3.2** — механизм расчёта компонент временной архитектуры зрительной реакции в проекте NeuroTransAnalytics версии v4.

Слой C3.2 выполняет **детерминированные алгоритмические вычисления** на основе событийных данных, подготовленных в C3.1 (ETL). Результатом работы слоя являются числовые значения компонент ΔV1, ΔV4 и ΔV5/MT для каждой валидной реакции.

---

## 2. Методологическая позиция слоя C3.2

В архитектуре v4 расчет компонент является **строго механическим процессом**.

Слой C3.2:

- не интерпретирует компоненты как биологические или психологические показатели;
- не оценивает когнитивное состояние субъекта;
- реализует универсальный расчёт, результат которого зависит исключительно от входных данных RT и структуры теста в `neuro_data.db`.

Все компоненты рассматриваются как **временные архитектурные координаты** реакции.

---

## 3. Входные данные для расчётов

Входом для C3.2 служат нормализованные события из **C3.1 (ETL)**:

- `StimulusEvent` (метаданные стимула из SQLite);
- `ResponseEvent` (значение RT из SQLite).

Вычисления опираются на зафиксированные в БД константы PSI и параметры дизайна тестов Tst1, Tst2 и Tst3.

---

## 4. Принцип компонентной декомпозиции

Общее время реакции (RT) рассматривается как совокупность (композиция) нескольких временных величин. В v4 используются три базовые компоненты:

- **ΔV1** — базовая составляющая, присутствующая во всех сценариях.
- **ΔV4** — дополнительная временная задержка, возникающая в условиях выбора цвета (тест Tst2).
- **ΔV5/MT** — дополнительная временная задержка, возникающая в условиях обработки сдвига/движения (тест Tst3).

Логика их выделения является **алгоритмическим инвариантом** и не изменяется в зависимости от целей анализа.

---

## 5. Расчёт базовой компоненты ΔV1

### 5.1 Назначение ΔV1

ΔV1 является опорной величиной временной архитектуры. Она вычисляется для всех тестов и служит базисом для определения производных компонент (ΔV4, ΔV5).

### 5.2 Алгоритм расчёта

Расчёт ΔV1 выполняется по фиксированной формуле, воспроизводящей исторически принятую в проекте методику декомпозиции RT.

- Вход: RT из таблицы `trials`.
- Параметры: PSI и позиция стимула из `metadata_simple`.
- Результат: Численное значение ΔV1.

### 5.3 Ограничения

ΔV1 — это вычислительная абстракция. Запрещено приписывать этой величине физиологические свойства или использовать её как самостоятельный показатель вне контекста архитектурной модели v4.

---

## 6. Расчёт производной компоненты ΔV4

### 6.1 Назначение ΔV4

ΔV4 рассчитывается для сессий теста Tst2 как разностная величина, характеризующая усложнение временной архитектуры при введении цветовой дифференцировки.

### 6.2 Алгоритм расчёта

ΔV4 определяется как детерминированная разность между RT в тесте Tst2 и базовой моделью ΔV1, с поправкой на алгоритмические коэффициенты, зафиксированные в методологии C1.

---

## 7. Расчёт производной компоненты ΔV5/MT

### 7.1 Назначение ΔV5/MT

ΔV5/MT рассчитывается для сессий теста Tst3 и характеризует временной вклад, связанный со структурным сдвигом стимула.

### 7.2 Алгоритм расчёта

Расчёт аналогичен ΔV4, но использует данные теста Tst3 и специфические метаданные пространственного сдвига из таблицы `metadata_shift`.

---

## 8. Выходные артефакты слоя C3.2

Результатом работы слоя является расширенный набор данных для каждой реакции:
`{ SubjectID, SessionID, StimulusIndex, RT, ΔV1, ΔV4, ΔV5/MT }`.

Эти данные передаются на этап **C3.3 (QC & Aggregation)** для проверки устойчивости и формирования аналитических выборок.
