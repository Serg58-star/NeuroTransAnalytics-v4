# Маппинг полей: исходные Excel-файлы → SQLite база neuro_data.db

**Актуальность**: на основе скриптов создания базы (`main.py`) и обновления `shift_parameter` (`update_shift_parameter.py`)

## Общее описание таблиц

| Таблица               | Назначение (кратко)                                                                 | Кол-во строк (примерно) |
|-----------------------|--------------------------------------------------------------------------------------|--------------------------|
| `users`               | Справочник участников (пациентов / испытуемых)                                       | ~1517                    |
| `trials`              | Основная таблица с результатами всех проведённых тестовых сессий                    | ~1892                    |
| `metadata_simple`     | Метаданные 36 предъявлений теста **простой реакции** (Tst1)                         | 36                       |
| `metadata_color_red`  | Метаданные 36 предъявлений теста **цветового различения** (Tst2, красный сигнал)    | 36                       |
| `metadata_shift`      | Метаданные 36 предъявлений теста **со сдвигом** (Tst3)                              | 36                       |
| `warmup_simple`       | Разминочные последовательности для теста простой реакции (Tst1)         | 30                       |
| `warmup_color_red`    | Разминочные последовательности для теста цветового различения (Tst2)                 | 30                       |
| `warmup_shift`        | Разминочные последовательности для теста со сдвигом (Tst3)                           | 30                       |
| `system_parameters`   | Системные константы и настройки эксперимента                                        | 5                        |

---

## 1. Таблица `users`

**Назначение**: Хранит информацию об участниках исследования.

**Ограничения и ключи**:

- `subject_id` — PRIMARY KEY
- `gender` CHECK (gender IN (0, 1))

**Поля и маппинг**:

| Исходное название     | Название в базе     | Тип     | Пример значения              | Описание / примечание                                 |
|-----------------------|---------------------|---------|------------------------------|-------------------------------------------------------|
| ID                    | subject_id          | INTEGER | 7, 8, 9, 1618, 1675          | Первичный ключ                                        |
| LName                 | last_name           | TEXT    | Омельченко, Романцова, Шутка | Фамилия                                               |
| YBorn                 | birth_date          | TEXT    | 1958-03-19, 1976-06-03       | Дата рождения (YYYY-MM-DD)                            |
| RegDate               | first_test_date     | TEXT    | 2011-09-24, 2025-08-19       | Дата первого тестирования                             |
| Gender                | gender              | INTEGER | 0, 1                         | 0 = женщина, 1 = мужчина                              |

---

## 2. Таблица `trials` из таблицы "boxbase.xlsx"

**Назначение**: Основная таблица с результатами всех сессий тестирования.

**Ограничения и ключи**:

- `trial_id` — PRIMARY KEY
- `subject_id` — FOREIGN KEY REFERENCES users(subject_id)

**Индексы**:

- idx_trials_subject (subject_id)
- idx_trials_date    (test_date)

**Поля и маппинг** (основные):

| Исходное название       | Название в базе       | Тип     | Пример значения               | Описание                                              |
|-------------------------|-----------------------|---------|-------------------------------|-------------------------------------------------------|
| cnt                     | trial_id              | INTEGER | 12, 13, 2110, 2114            | Уникальный номер записи                               |
| CurrentDate             | test_date             | TEXT    | 2011-09-24, 2025-08-27        | Дата проведения теста                                 |
| CurrentTime             | test_time             | TEXT    | 10:26:02, 19:40:56            | Время начала сессии                                   |
| REG_ID                  | subject_id            | INTEGER | 8, 9, 1672, 1644              | Ссылка на участника                                   |
| VidSost_txt             | session_condition     | INTEGER | 1, 2, 3                       | 1=утро, 2=обед, 3=вечер и др.                         |
| Tst1_1 … Tst1_36        | tst1_1 … tst1_36      | REAL    | 188, 209, 271, 255, ...       | Время реакции — простая реакция (36 значений)         |
| RANO_POKAZ_1            | tst1_premature        | INTEGER | 2, 7, 0, 4                    | Преждевременные нажатия (simple)                      |
| POZDNO_POKAZ_1          | tst1_late             | INTEGER | 0, 0, 1, 0                    | Опоздания (simple)                                    |
| result_1                | tst1_mean             | REAL    | 211, 269, 300, 253            | Среднее время реакции (simple)                        |
| SrKvadrOtkl_1           | tst1_std              | REAL    | 17, 44, 29, 34                | Стандартное отклонение (simple)                       |
| ... (аналогично для tst2 и tst3) | ...              | ...     | ...                           | ...                                                   |

---

## 3–5. Таблицы метаданных тестов (metadata_*)

**Общее назначение** — описание характеристик каждого из 36 предъявлений в каждом из трёх типов тестов.

### metadata_simple

**CHECK**:

- color IN ('red', 'green', 'blue')
- position IN ('left', 'center', 'right')

**Поля**:

| Поле          | Тип     | Пример значения       | Описание                          |
|---------------|---------|-----------------------|-----------------------------------|
| stimulus_id   | INTEGER | 1, 12, 25, 36         | Порядковый номер предъявления     |
| color         | TEXT    | green, blue, red      | Цвет стимула                      |
| position      | TEXT    | left, center, right   | Положение на экране               |
| psi_ms        | INTEGER | 1045, 1540, 2340      | Предстимульный интервал (мс)      |

### metadata_color_red

**Поля**:

| Поле          | Тип     | Пример значения                       | Описание                              |
|---------------|---------|---------------------------------------|---------------------------------------|
| stimulus_id   | INTEGER | 1, 17, 36                             | Порядковый номер                      |
| color         | TEXT    | red                                   | Всегда red                            |
| position      | TEXT    | left, center, right                   | Положение тестового сигнала           |
| psi_ms        | INTEGER | 800, 1200, 1600, 2000, 2400, 2800     | Предстимульный интервал               |
| mask_triples  | TEXT    | ЖЖС ЖСЖ ССЖ ЖЖЖ ЖСК ...               | Полная последовательность троек       |

### metadata_shift

**Поля**:

| Поле              | Тип     | Пример значения                       | Описание                              |
|-------------------|---------|---------------------------------------|---------------------------------------|
| stimulus_id       | INTEGER | 1, 13, 28                             | Порядковый номер                      |
| color             | TEXT    | green, blue, red                      | Цвет тестового сигнала                |
| position          | TEXT    | left, center, right                   | Положение тестового сигнала           |
| psi_ms            | INTEGER | 800, 1200, 1600, 2000, 2400           | Предстимульный интервал               |
| mask_triples      | TEXT    | ЖЖС0 ССЖ0 КЖК0 ЖСС0 ЖКЖ1 ...          | Полная последовательность троек       |
| shift_parameter   | INTEGER | 0, 1, 2, 3                            | **Заполнено после update_shift_parameter.py** |

---

## 6–8. Таблицы разминочных стимулов (warmup_*)

**Назначение**: Разминочные последовательности предъявлений для каждого типа теста (по 10 вариантов × 3 предъявления).

**Первичные ключи**: составные — `(variant, order_num)`

### warmup_simple

| Поле       | Тип     | Пример                  |
|------------|---------|-------------------------|
| variant    | TEXT    | NU0, NU3, NU7           |
| order_num  | INTEGER | 1, 2, 3                 |
| psi_ms     | INTEGER | 1045, 1540, 2340        |
| color      | TEXT    | green, blue, red        |
| position   | TEXT    | left, right, center     |

### warmup_color_red

| Поле              | Тип     | Пример            |
|-------------------|---------|-------------------|
| variant           | TEXT    | NU0, NU5, NU9     |
| order_num         | INTEGER | 1, 2, 3           |
| psi_ms            | INTEGER | 800, 1200, 2000   |
| last_mask_triple  | TEXT    | ССЖ, ЖСЖ, ЖЖЖ     |
| test_triple       | TEXT    | СКС, КЖС, ЖСК     |
| test_position     | TEXT    | center, left, right |

### warmup_shift

| Поле              | Тип     | Пример            |
|-------------------|---------|-------------------|
| variant           | TEXT    | NU0, NU4, NU8     |
| order_num         | INTEGER | 1, 2, 3           |
| psi_ms            | INTEGER | 800, 1600, 2400   |
| last_mask_triple  | TEXT    | КЖК0, ССК0        |
| test_triple       | TEXT    | ЖКЖ1, СКС3        |
| shift_position    | TEXT    | left, center, right |
| test_color        | TEXT    | green, blue       |

---

## 9. Таблица `system_parameters`

**Назначение**: Хранение констант экспериментальной установки.

**Первичный ключ**: `param_key`

**Примеры записей**:

| param_key       | param_value |
|-----------------|-------------|
| MaxRedLight     | 2000        |
| MinRedLight     | 135         |
| ROTATE_PERIOD   | 400         |
| POKAZ_COUNT     | 36          |
| NoUchtPOKAZ_COUNT | 3         |

---
